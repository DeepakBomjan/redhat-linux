```yaml
---
- name: Monitor directory and copy new files
  hosts: localhost
  gather_facts: no

  vars:
    watch_directory: /path/to/watch
    destination_directory: /path/to/destination

  tasks:
    - name: Find new files in the directory
      find:
        paths: "{{ watch_directory }}"
        age: 1m
      register: new_files

    - name: Notify handler if new files are found
      debug:
        msg: "New files found, triggering handler."
      when: new_files.matched > 0
      notify: Copy new files to destination

  handlers:
    - name: Copy new files to destination
      copy:
        src: "{{ item.path }}"
        dest: "{{ destination_directory }}"
      with_items: "{{ new_files.files }}"
      when: new_files.matched > 0
```

## FTP Server Configuration
```yaml
---
- name: Configure FTP server
  hosts: ftp_servers
  become: yes
  vars:
    ftp_user: ftpuser
    ftp_password: ftppassword
    ftp_home: /home/ftpuser
    ftp_config_file: /etc/vsftpd.conf

  tasks:
    - name: Ensure vsftpd is installed
      apt:
        name: vsftpd
        state: present
      notify:
        - Restart vsftpd

    - name: Ensure ftp user exists
      user:
        name: "{{ ftp_user }}"
        password: "{{ ftp_password | password_hash('sha512') }}"
        home: "{{ ftp_home }}"
        state: present
        create_home: yes
      notify:
        - Restart vsftpd

    - name: Configure vsftpd
      lineinfile:
        path: "{{ ftp_config_file }}"
        state: present
        create: yes
        line: "{{ item }}"
      with_items:
        - "listen=YES"
        - "anonymous_enable=NO"
        - "local_enable=YES"
        - "write_enable=YES"
        - "local_umask=022"
        - "dirmessage_enable=YES"
        - "use_localtime=YES"
        - "xferlog_enable=YES"
        - "connect_from_port_20=YES"
        - "chroot_local_user=YES"
        - "secure_chroot_dir=/var/run/vsftpd/empty"
        - "pam_service_name=vsftpd"
        - "rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem"
        - "rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key"
      notify:
        - Restart vsftpd

    - name: Ensure vsftpd service is enabled and started
      service:
        name: vsftpd
        enabled: yes
        state: started

  handlers:
    - name: Restart vsftpd
      service:
        name: vsftpd
        state: restarted
```

### Single Playbook Example with Apache
```yaml
---
- name: Configure HTTP server and deploy index.html
  hosts: http_servers
  become: yes
  vars:
    http_server_name: "example.com"
    http_root: "/var/www/html"
    index_html_src: "templates/index.html.j2"

  tasks:
    - name: Install Apache
      apt:
        name: apache2
        state: present
      notify:
        - Restart Apache

    - name: Create directory for website
      file:
        path: "{{ http_root }}"
        state: directory
        mode: "0755"

    - name: Deploy index.html
      template:
        src: "{{ index_html_src }}"
        dest: "{{ http_root }}/index.html"
      notify:
        - Restart Apache

  handlers:
    - name: Restart Apache
      service:
        name: apache2
        state: restarted

```

### Jinja2 Template Example (templates/index.html.j2)
```yaml
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Welcome to {{ http_server_name }}</title>
</head>
<body>
    <h1>Welcome to {{ http_server_name }}</h1>
    <p>This is a custom landing page served by Ansible with Apache!</p>
</body>
</html>
```

### Jinja2 Template for httpd.conf

```yaml
# Example httpd.conf file generated by Ansible

# Global settings
ServerRoot "{{ apache_server_root }}"
Listen {{ apache_listen_port }}

# Include modules
{% for module in apache_modules %}
LoadModule {{ module.name }} {{ module.path }}
{% endfor %}

# Virtual Hosts
{% for vhost in apache_virtual_hosts %}
<VirtualHost *:{{ vhost.port }}>
    ServerAdmin {{ vhost.admin_email }}
    DocumentRoot "{{ vhost.document_root }}"
    ServerName {{ vhost.server_name }}

    <Directory "{{ vhost.document_root }}">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    ErrorLog "{{ vhost.error_log }}"
    CustomLog "{{ vhost.custom_log }}" combined
</VirtualHost>
{% endfor %}
```
### Option 1: Defining Variables in the Playbook
```yaml
---
- name: Configure Apache HTTP Server
  hosts: apache_servers
  become: yes

  vars:
    apache_server_root: "/etc/apache2"
    apache_listen_port: 80
    apache_modules:
      - name: "mod_ssl.so"
        path: "modules/mod_ssl.so"
      # Add more modules as needed
    apache_virtual_hosts:
      - port: 80
        admin_email: "admin@example.com"
        document_root: "/var/www/html"
        server_name: "example.com"
        error_log: "/var/log/apache2/error.log"
        custom_log: "/var/log/apache2/access.log"
      # Add more virtual hosts as needed

  tasks:
    # Task to deploy httpd.conf using the provided template
```
### Option 2: Defining Variables in Separate Files
```yaml
apache_server_root: "/etc/apache2"
apache_listen_port: 80
apache_modules:
  - name: "mod_ssl.so"
    path: "modules/mod_ssl.so"
  # Add more modules as needed
apache_virtual_hosts:
  - port: 80
    admin_email: "admin@example.com"
    document_root: "/var/www/html"
    server_name: "example.com"
    error_log: "/var/log/apache2/error.log"
    custom_log: "/var/log/apache2/access.log"
  # Add more virtual hosts as needed

```
### playbook.yml
```yaml
---
- name: Configure Apache HTTP Server
  hosts: apache_servers
  become: yes

  vars_files:
    - vars/apache_vars.yml

  tasks:
    # Task to deploy httpd.conf using the provided template
```


